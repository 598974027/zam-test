<!DOCTYPE>
<html>
<head>
    <meta charset="utf-8">
    <title>数据表格</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" href="../js/layui/css/layui.css" media="all">
</head>
<body>
<div class="demoTable">
    搜索ID：
    <div class="layui-inline">
        <input class="layui-input" name="id" id="demoReload" autocomplete="off">
    </div>
    <button class="layui-btn" id="reload" data-type="reload">搜索</button>
</div>
<table class="layui-hide" id="test" lay-filter="test"></table>
<script type="text/html" id="toolbarDemo">
    <div class="layui-btn-container">
        <button class="layui-btn layui-btn-sm" lay-event="getCheckData">获取选中行数据</button>
        <button class="layui-btn layui-btn-sm" lay-event="getCheckLength">获取选中数目</button>
        <button class="layui-btn layui-btn-sm" lay-event="isAll">验证是否全选</button>
    </div>
</script>
<script type="text/html" id="barDemo">
    <a class="layui-btn layui-btn-xs" lay-event="edit">编辑</a>
    <a class="layui-btn layui-btn-danger layui-btn-xs" lay-event="del">删除</a>
</script>
<script src="../js/layui/layui.js" charset="utf-8"></script>
<script>
    layui.use('table', function () {
        var $ = layui.jquery, table = layui.table;
        var tableIns = table.render({
            elem: '#test',
            id: 'testReload',
            // width: 300,
            // height: 500
            // url: '',
            // where: {token: '', id: 10000 } //如果无需传递额外参数，可不加该参数
            // method: 'post' //如果无需自定义HTTP类型，可不加该参数
            // request: {} //如果无需自定义请求参数，可不加该参数
            // response: {} //如果无需自定义数据响应名称，可不加该参数
            data: [{
                "id": 10000,
                "username": "user-0",
                "sex": "女",
                "city": "城市-0",
                "sign": "签名-0",
                "experience": 255,
                "logins": 24,
                "wealth": 82830700,
                "classify": "作家",
                "score": 57
            }, {
                "id": 10001,
                "username": "user-1",
                "sex": "男",
                "city": "城市-1",
                "sign": "签名-1",
                "experience": 884,
                "logins": 58,
                "wealth": 64928690,
                "classify": "词人",
                "score": 27
            }, {
                "id": 10002,
                "username": "user-2",
                "sex": "女",
                "city": "城市-2",
                "sign": "签名-2",
                "experience": 650,
                "logins": 77,
                "wealth": 6298078,
                "classify": "酱油",
                "score": 31
            }, {
                "id": 10003,
                "username": "user-3",
                "sex": "女",
                "city": "城市-3",
                "sign": "签名-3",
                "experience": 362,
                "logins": 157,
                "wealth": 37117017,
                "classify": "诗人",
                "score": 68
            }, {
                "id": 10004,
                "username": "user-4",
                "sex": "男",
                "city": "城市-4",
                "sign": "签名-4",
                "experience": 807,
                "logins": 51,
                "wealth": 76263262,
                "classify": "作家",
                "score": 6
            }, {
                "id": 10005,
                "username": "user-5",
                "sex": "女",
                "city": "城市-5",
                "sign": "签名-5",
                "experience": 173,
                "logins": 68,
                "wealth": 60344147,
                "classify": "作家",
                "score": 87
            }, {
                "id": 10006,
                "username": "user-6",
                "sex": "女",
                "city": "城市-6",
                "sign": "签名-6",
                "experience": 982,
                "logins": 37,
                "wealth": 57768166,
                "classify": "作家",
                "score": 34
            }, {
                "id": 10007,
                "username": "user-7",
                "sex": "男",
                "city": "城市-7",
                "sign": "签名-7",
                "experience": 727,
                "logins": 150,
                "wealth": 82030578,
                "classify": "作家",
                "score": 28
            }, {
                "id": 10008,
                "username": "user-8",
                "sex": "男",
                "city": "城市-8",
                "sign": "签名-8",
                "experience": 951,
                "logins": 133,
                "wealth": 16503371,
                "classify": "词人",
                "score": 14
            }, {
                "id": 10009,
                "username": "user-9",
                "sex": "女",
                "city": "城市-9",
                "sign": "签名-9",
                "experience": 484,
                "logins": 25,
                "wealth": 86801934,
                "classify": "词人",
                "score": 75
            }, {
                "id": 10010,
                "username": "user-10",
                "sex": "女",
                "city": "城市-0",
                "sign": "签名-0",
                "experience": 255,
                "logins": 24,
                "wealth": 82830700,
                "classify": "作家",
                "score": 57
            }, {
                "id": 10011,
                "username": "user-11",
                "sex": "男",
                "city": "城市-1",
                "sign": "签名-1",
                "experience": 884,
                "logins": 58,
                "wealth": 64928690,
                "classify": "词人",
                "score": 27
            }, {
                "id": 10012,
                "username": "user-12",
                "sex": "女",
                "city": "城市-2",
                "sign": "签名-2",
                "experience": 650,
                "logins": 77,
                "wealth": 6298078,
                "classify": "酱油",
                "score": 31
            }, {
                "id": 10013,
                "username": "user-13",
                "sex": "女",
                "city": "城市-3",
                "sign": "签名-3",
                "experience": 362,
                "logins": 157,
                "wealth": 37117017,
                "classify": "诗人",
                "score": 68
            }, {
                "id": 10014,
                "username": "user-14",
                "sex": "男",
                "city": "城市-4",
                "sign": "签名-4",
                "experience": 807,
                "logins": 51,
                "wealth": 76263262,
                "classify": "作家",
                "score": 6
            }, {
                "id": 10015,
                "username": "user-15",
                "sex": "女",
                "city": "城市-5",
                "sign": "签名-5",
                "experience": 173,
                "logins": 68,
                "wealth": 60344147,
                "classify": "作家",
                "score": 87
            }, {
                "id": 10016,
                "username": "user-16",
                "sex": "女",
                "city": "城市-6",
                "sign": "签名-6",
                "experience": 982,
                "logins": 37,
                "wealth": 57768166,
                "classify": "作家",
                "score": 34
            }, {
                "id": 10017,
                "username": "user-17",
                "sex": "男",
                "city": "城市-7",
                "sign": "签名-7",
                "experience": 727,
                "logins": 150,
                "wealth": 82030578,
                "classify": "作家",
                "score": 28
            }, {
                "id": 10018,
                "username": "user-18",
                "sex": "男",
                "city": "城市-8",
                "sign": "签名-8",
                "experience": 951,
                "logins": 133,
                "wealth": 16503371,
                "classify": "词人",
                "score": 14
            }, {
                "id": 10019,
                "username": "user-19",
                "sex": "女",
                "city": "城市-9",
                "sign": "签名-9",
                "experience": 484,
                "logins": 25,
                "wealth": 86801934,
                "classify": "词人",
                "score": 75
            }],
            cols: [[
                {type: 'checkbox'},
                {field: 'id', width: 80, title: 'ID', sort: true},
                {field: 'username', width: 100, title: '用户名', edit: 'text'},
                {field: 'sex', width: 80, title: '性别', sort: true},
                {field: 'city', width: 80, title: '城市'},
                {
                    field: 'sign', title: '签名', minWidth: 150, edit: 'text', templet: function (res) {
                        return '<em>' + res.sign + '</em>'
                    }
                },
                {field: 'experience', width: 80, title: '积分', sort: true},
                {field: 'score', width: 80, title: '评分', sort: true},
                {field: 'classify', width: 80, title: '职业'},
                {field: 'wealth', width: 135, title: '财富', sort: true},
                {fixed: 'right', width: 150, title: '操作', toolbar: '#barDemo'}
            ]],
            toolbar: '#toolbarDemo', //开启头部工具栏，并为其绑定左侧模板,
            defaultToolbar: ['filter', 'exports', 'print', { //自定义头部工具栏右侧图标。如无需自定义，去除该参数即可
                title: '提示',
                layEvent: 'zam',
                icon: 'layui-icon-tips'
            }],
            title: '用户数据表',
            page: {
                layout: ['limit', 'count', 'prev', 'page', 'next', 'skip'], //自定义分页布局
                curr: 2, //设定初始在第2页
                groups: 5, //只显示5个连续页码
                first: false, //不显示首页
                last: false //不显示尾页
            },
            limit: 5,
            limits: [5, 10, 15],
            done: function (res, curr, count) {
                //如果是异步请求数据方式，res即为你接口返回的信息。
                //如果是直接赋值的方式，res即为：{data: [], count: 99} data为当前页数据、count为数据总长度
                console.log(res);
                //得到当前页码
                console.log(curr);
                //得到数据总量
                console.log(count);
            }
        });
        //工具栏事件
        table.on('toolbar(test)', function (obj) {
            var checkStatus = table.checkStatus(obj.config.id);
            var data = checkStatus.data;
            switch (obj.event) {
                case 'getCheckData':
                    layer.alert(JSON.stringify(data));
                    break;
                case 'getCheckLength':
                    layer.msg('选中了：' + data.length + ' 个');
                    break;
                case 'isAll':
                    layer.msg(checkStatus.isAll ? '全选' : '未全选');
                    break;
                //自定义头工具栏右侧图标 - 提示
                case 'zam':
                    layer.alert('这是工具栏右侧自定义的一个图标按钮');
                    break;
            }
            ;
        });
        //工具条事件
        //注：tool 是工具条事件名，test 是 table 原始容器的属性 lay-filter="对应的值"
        table.on('tool(test)', function (obj) {
            if (obj.event === 'del') {
                layer.confirm('真的删除行么', function (index) {
                    obj.del(); //删除对应行（tr）的DOM结构，并更新缓存
                    layer.close(index);
                });
            } else if (obj.event === 'edit') {
                layer.prompt({
                    formType: 2,
                    value: obj.data.sign
                }, function (value, index) {
                    obj.update({
                        sign: value
                    });
                    layer.close(index);
                });
            }
        });
        var active = {
            reload: function () {
                //执行重载
                table.reload('testReload', {
                    //设定异步数据接口的额外参数
                    where: {
                        key: {
                            id: $('#demoReload').val()
                        }
                    },
                    page: {
                        curr: 1 //重新从第1页开始
                    }
                });
            }
        };
        $('#reload').on('click', function () {
                var type = $(this).data('type');
                active[type] ? active[type].call(this) : '';
            }
        );
    });
</script>
</body>
</html>